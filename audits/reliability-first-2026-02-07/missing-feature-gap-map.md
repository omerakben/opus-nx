# Missing Feature Gap Map (Docs vs Implementation)

| Gap ID | Claimed Capability | Source Doc(s) | Implementation Status | Gap Type | Required Components | Priority | Evidence |
| --- | --- | --- | --- | --- | --- | --- | --- |
| `GAP-01` | Specialized agents (research/code/knowledge/planning/communication) are available for orchestration | `ROADMAP.md`, `ARCHITECTURE.md` | Agent package exports are placeholders; no concrete agent modules exported | Not implemented | Agent interfaces, concrete agent modules, registry, orchestration wiring, tests | P1 | `packages/agents/src/index.ts:4`, `packages/core/src/orchestrator.ts:606` |
| `GAP-02` | Contradiction resolution engine with audit trail | `README.md`, `ARCHITECTURE.md`, `ROADMAP.md` | Contradiction table exists in SQL, but no core resolver module/export is present | Not implemented | `types/contradiction`, resolver service, integration into memory/orchestrator, tests | P1 | `README.md:50`, `ARCHITECTURE.md:201`, `ROADMAP.md:899`, `packages/core/src/index.ts:1` |
| `GAP-03` | API contract uses `POST /api/think` | `ARCHITECTURE.md`, `ROADMAP.md` | Implemented endpoint is `POST /api/thinking` | Implemented but contract drifted | Route alias or doc update + contract checks | P1 | `ARCHITECTURE.md:806`, `ROADMAP.md:1192`, `apps/web/src/app/api/thinking/route.ts:12` |
| `GAP-04` | Streaming contract uses `SSE /api/stream/:sessionId` | `ARCHITECTURE.md`, `ROADMAP.md` | Implemented endpoint is `POST /api/thinking/stream` | Implemented but contract drifted | Contract update and streaming API docs/tests | P1 | `ARCHITECTURE.md:881`, `ROADMAP.md:1152`, `apps/web/src/app/api/thinking/stream/route.ts:13` |
| `GAP-05` | Reasoning endpoint `/api/reasoning/:id` is available | `ARCHITECTURE.md`, `ROADMAP.md` | Current graph endpoint is `/api/sessions/:sessionId/nodes`; no `/api/reasoning/:id` route | Partially implemented | Add reasoning-by-id route or update docs and clients | P2 | `ARCHITECTURE.md:28`, `ROADMAP.md:1199`, `apps/web/src/app/api/sessions/[sessionId]/nodes/route.ts:9` |
| `GAP-06` | `nodeType` should support compaction/fork/human annotation across system | Core types and UI imply support | DB schema and DB TS types omit durable `node_type`; core maps optional override only | Partially implemented | DB migration, db type updates, API contract updates, round-trip tests | P0 | `packages/core/src/types/thinking.ts:73`, `apps/web/src/lib/graph-utils.ts:25`, `packages/db/src/thinking-nodes.ts:31`, `supabase/migrations/002_thinking_graph.sql:17` |
| `GAP-07` | Environment template fully covers runtime-required vars | Root setup docs and `.env.example` | Auth route requires `AUTH_SECRET`, but `.env.example` omits it | Implemented but not production-hardened | Update env template, shared env schema, startup check | P0 | `apps/web/src/app/api/auth/route.ts:11`, `.env.example:1`, `packages/shared/src/config.ts:44` |
| `GAP-08` | Single migration path and schema ownership clarity | Architecture and project maintainability expectation | Two migration directories are maintained in parallel (`supabase` and `packages/db`) | Implemented but not production-hardened | Canonical migration source + CI drift gate + docs update | P0 | `supabase/migrations/002_thinking_graph.sql:1`, `packages/db/migrations/002_thinking_graph.sql:1` |
| `GAP-09` | Orchestrator routes tasks to specialized sub-agents | `packages/core` class documentation and roadmap intent | Orchestrator currently parses plan/tool output, but no concrete handoff to `@opus-nx/agents` | Partially implemented | Agent execution pipeline, task lifecycle state machine, retries, tests | P1 | `packages/core/src/orchestrator.ts:106`, `packages/core/src/orchestrator.ts:647`, `packages/core/src/orchestrator.ts:1` |

## Notes
- Gaps marked P0 are reliability blockers and should precede new feature expansion.
- Gaps marked contract drift can be resolved by code aliases, doc updates, or both; use a doc-contract test to prevent re-drift.
